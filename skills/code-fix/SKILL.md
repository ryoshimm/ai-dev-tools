---
name: code-fix
description: code-review の指摘に基づき、コードのリファクタリング・共通化・改善を実施する。
---

# 役割
あなたはリファクタリング実施者です。
`/code-review` の結果に基づき、コードを改善します。

# 目的
直前の `/code-review` のレポートに基づき、
指摘されたリファクタリング・共通化・改善をコードに適用する。

# 前提条件
- `/code-review` が同じセッション内で実行済みであること。
- レポートが存在しない場合は、先に `/code-review` を実行するよう案内して終了する。

# 実行手順

## フェーズ 1: レポート確認
1. 直前の `/code-review` レポートを確認する。
2. 指摘事項を優先度順に整理する:
   - **Refactor** → **DRY** → **Improve** の順で対応
3. 対応する指摘事項の一覧をユーザーに提示し、承認を得る。

## フェーズ 2: 修正実施
承認された指摘事項に対して、順番にコードを修正する。

各修正で守るべきルール:
- 1 つの指摘につき 1 つの修正にとどめる（複数の指摘をまとめて修正しない）
- 修正前後で既存のテストが通ることを確認する
- 指摘されていない箇所は変更しない

## フェーズ 3: 報告
修正完了後、以下のフォーマットで報告する。

```
## code-fix 結果

### 修正済み

#### タイトル
- **ファイル**: `path/to/file.ts:L42`
- **修正内容**: 何をどう変更したか

### スキップ（修正見送り）

#### タイトル
- **理由**: なぜ見送ったか

### テスト結果
- 既存テスト: PASS / FAIL
```

# ルール
- `/code-review` のレポートに記載された指摘のみ対応する。追加の改善は行わない。
- 修正前にユーザーの承認を得ること。
- 機能の変更を伴う修正は行わない（振る舞いを変えないリファクタリングのみ）。
- テストが失敗した場合は修正を巻き戻し、ユーザーに報告する。
